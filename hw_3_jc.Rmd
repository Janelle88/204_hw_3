---
title: "ESM 204 HW 3"
author: "Janelle Christensen"
date: "5/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r}

# ------------
# attach packages and read in csv
# ------------

library(tidyverse)
library(janitor)
library(stargazer)
library(wesanderson)

gas_df <- read_csv("Homework 3 Data.csv") %>% 
  clean_names()

```

#### 1.

```{r}

# -----------
# graph high and low and aggregate
# -----------

gas_agg_df <- gas_df %>% 
  mutate(q_agg_gallons = q_low_gallons + q_high_gallons) %>% 
  pivot_longer(q_low_gallons:q_agg_gallons,
               names_to = "consumer",
               values_to = "quantity") %>% 
  mutate(quantity = quantity/1000)

ggplot(data = gas_agg_df, aes(x = quantity, y = price_dollars, color = consumer)) +
  geom_point() +
  theme_light() +
  scale_color_manual(values = wes_palette("Darjeeling1")) +
  labs(x = "Quantity (thousands of gallons)",
       y = "Price ($)",
       color = "Consumer")
  

```

```{r}

gas_low_df <- gas_agg_df %>% 
  filter(consumer %in% c("q_low_gallons"))

model_low <- lm(price_dollars ~ quantity, data = gas_low_df)

gas_high_df <- gas_agg_df %>% 
  filter(consumer %in% c("q_high_gallons"))

model_high <- lm(price_dollars ~ quantity, data = gas_high_df)

gas_tot_df <- gas_agg_df %>% 
  filter(consumer %in% c("q_agg_gallons"))

model_agg <- lm(price_dollars ~ quantity, data = gas_tot_df)


q_3_agg <- ((3 - 15.0021) / -.0204) * 1000

q_3_high <- ((3 - 15.8034) / -0.0273) * 1000

q_3_low <- ((3 - 11.6855) / -0.0661) * 1000

cons_benefit_3 <- (15.0021 - 3) * q_3_agg * .5

prod_benefit_3 <-  3 * q_3_agg * .5

env_cost_local_3 <- 1.5 * q_3_agg

env_cost_world_3 <- 0.5 * q_3_agg

```

Aggregate quantity of gallons sold at 3.00/gallon is `r format(round(q_3_agg, 0), scientific=FALSE)`

Consumer benefit at 3.00/gallon is $`r format(round(cons_benefit_3, 0), scientific=FALSE)`

Producer benefit at 3.00/gallon is $`r format(round(prod_benefit_3, 0), scientific=FALSE)`

The local environmental externality cost is $`r format(round(env_cost_local_3, 0), scientific=FALSE)`

The environmental externality cost to the rest of the world is $`r format(round(env_cost_world_3, 0), scientific=FALSE)`

#### 2. 

```{r}

high_benefit_3 <- (15.8034 - 3) * q_3_high * 0.5

low_benefit_3 <- (11.6855 - 3) * q_3_low * 0.5

```

Benefit of high income consumers is approximately $`r format(round(high_benefit_3, 0), scientific=FALSE)`

Benefit of low income consumers is approximately $`r format(round(low_benefit_3, 0), scientific=FALSE)`